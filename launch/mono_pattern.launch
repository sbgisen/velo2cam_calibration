<launch>

    <arg name="stdout" default="screen" />
    <arg name="camera_name" default="/mono_camera" />
    <arg name="image_topic" default="image_color" />
    <arg name="frame_name" default="mono_camera" />
    <arg name="sensor_id" default="0" />
    <arg name="manager" default="manager" />
    <!-- Marker size (side) in meters -->
    <arg name="marker_size" value="0.2"/>

    <node name="zero_distortion_publisher" pkg="velo2cam_calibration" type="zero_distortion_info_publisher.py" output="screen">
      <remap from="~output" to="/insta360/rgb/rear/rectify/camera_info"/>
      <remap from="~input" to="/insta360/rgb/rear/camera_info"/>
    </node>

    <node pkg="velo2cam_calibration" type="mono_qr_pattern" name="mono_pattern_$(arg sensor_id)" output="$(arg stdout)">
        <param name="image_topic" value="$(arg camera_name)/$(arg image_topic)" />
        <param name="cinfo_topic" value="$(arg camera_name)/camera_info" />
        <param name="marker_size" value="$(arg marker_size)"/>
    </node>

    <node pkg="tf" type="static_transform_publisher" name="camera_ros_tf_$(arg sensor_id)" args="0 0 0 -1.57079632679 0 -1.57079632679 rotated_$(arg frame_name) $(arg frame_name) 10"/>


    <node pkg="nodelet" type="nodelet" name="$(arg manager)" args="manager" output="screen" launch-prefix="nice -n 19"/>

    <node pkg="nodelet" type="nodelet" name="rectify_color" args="load image_proc/rectify $(arg manager)">
        <remap from="image_mono" to="/insta360/rgb/rear/image_raw" />
        <remap from="image_rect" to="/insta360/rgb/rear/image_rect_color" />
        <remap from="camera_info" to="/insta360/rgb/rear/camera_info" />
    </node>  


</launch>
